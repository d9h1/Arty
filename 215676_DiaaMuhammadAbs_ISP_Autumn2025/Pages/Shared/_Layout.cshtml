@using System.Linq
@using _215676_DiaaMuhammadAbs_ISP_Autumn2025.Models
@using _215676_DiaaMuhammadAbs_ISP_Autumn2025.Services
@using Microsoft.AspNetCore.Identity
@inject SignInManager<IdentityUser> SignInManager
@inject UserManager<IdentityUser> UserManager

@inject _215676_DiaaMuhammadAbs_ISP_Autumn2025.Services.ApplicationDbContext db
@{
    var navCategories = db.Categories.ToList();
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Arty | Art shop</title>
    <link rel="icon" type="image/x-icon" href="~/Pic/icon.png">
    <link rel="stylesheet" href="~/css/stylesheet.CSS" />
    <script src="https://kit.fontawesome.com/8f27d68390.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

    @RenderSection("Styles", required: false)

</head>
<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <a href="~/">Arty | Art Shop</a>
            </div>
            <ul class="nav-links">
                <li><a href="~/">Home</a></li>
                <li class="dropdown">
                    <a href="#" class="dropbtn">Categories</a>
                    <div class="dropdown-content">
                        @if (navCategories != null)
                        {
                            @foreach (var category in navCategories)
                            {
                                <a asp-page="CategoryProducts" asp-route-id="@category.Id" class="nav-link">
                                    @category.Name
                                </a>
                            }
                        }
                        else
                        {
                            <a href="#">Loading...</a>
                        }

                    </div>
                </li>
                <li><a href="#End-footer">About</a></li>
                <li><a href="#End-footer">Contact</a></li>
            </ul>
            <div class="nav-icons">
                <li class="dropdown">
                    <a class="Account-dropbtn">🧑🏻‍🎨Account</a>
                    <div class="dropdown-content">

                        @if (SignInManager.IsSignedIn(User))
                        {
                            <a href="/Dashboard">My Dashboard</a>

                            @if (!User.IsInRole("Admin"))
                            {
                                <a href="~/Orders">Orders</a>
                            }

                            <form asp-area="Identity" asp-page="/Account/Logout" asp-route-returnUrl="/" method="post" id="logoutForm">
                                <a href="javascript:document.getElementById('logoutForm').submit()" class="nav-link">Logout</a>
                            </form>
                        }
                        else
                        {
                            <a asp-area="Identity" asp-page="/Account/Login">Login</a>
                            <a asp-area="Identity" asp-page="/Account/Register">Register an account</a>
                        }
                    </div>
                </li>
                @inject SignInManager<IdentityUser> SignInManager

                @if (SignInManager.IsSignedIn(User))
                {
                    @if (User.IsInRole("Customer") || User.IsInRole("Seller"))
                    {
                        <a asp-page="/ShoppingCart" class="cart-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                                 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="feather feather-shopping-cart">
                                <circle cx="9" cy="21" r="1"></circle>
                                <circle cx="20" cy="21" r="1"></circle>
                                <path d="M1 1h4l2.68 13.39a2 2 0 0 0 1.95 1.61h9.71a2 2 0 0 0 1.95-1.61L23 6H6"></path>
                            </svg>
                        </a>
                    }
                }
            </div>
        </nav>
    </header>

    <main role="main" class="pb-3">
        @RenderBody()
    </main>

    <footer id="End-footer" class="End-footer">
        <div class="footer-left">
            <h3>Arty | Art Shop</h3>
            <br>
            <div class="footer-icons">
                <a href="https://www.facebook.com/"><i class="fa fa-facebook"></i></a>
                <a href="https://www.instagram.com/"><i class="fa fa-instagram"></i></a>
                <a href="https://web.whatsapp.com/"><i class="fa fa-whatsapp"></i></a>
            </div>
        </div>

        <div class="footer-center">
            <h4>Need help? Contact us..</h4>
            <br>
            <div>
                <i class="fa fa-phone"></i>
                <p>800101</p>
            </div>
            <div>
                <i class="fa fa-envelope"></i>
                <p>info@arty.ae</p>
            </div>
        </div>
        <div class="footer-right">
            <p class="footer-company-about">
                <span>About Arty</span>
                <strong>Arty</strong> is a Retail art shop that offers a wide range of high-quality art supplies, tools,
                and accessories for artists of all levels. Our mission is to provide artists with the best products and
                services to help them unleash their creativity and bring their artistic visions to life.
            </p>
        </div>
    </footer>
    @await RenderSectionAsync("Scripts", required: false)
</body>
</html>